# seed_db.py
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from contextlib import contextmanager

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –∏–∑ –≤–∞—à–µ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
from sqlalchemy import Column, Integer, String
from sqlalchemy.orm import declarative_base

Base = declarative_base()


class Topic(Base):
    __tablename__ = "topics"
    id = Column(Integer, primary_key=True)
    title = Column(String, nullable=False)
    content = Column(String, nullable=False)


# --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ---
DATABASE_URL = "sqlite:///bot.db"  # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ –≤–∞—à–µ–π –ë–î –≤–µ—Ä–Ω—ã–π
engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(bind=engine)


@contextmanager
def get_session():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()


# --- –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è ---
# –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã Topic –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã —Ä–∞—Å—à–∏—Ä—è—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
topics_to_add = [
    Topic(
        title="üöÄ –û –∫–æ–º–ø–∞–Ω–∏–∏",
        content=(
            "<b>–ù–∞—à–∞ –º–∏—Å—Å–∏—è:</b> .\n\n"
            "<b>–ù–∞—à–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏:</b>\n"
            "1. <i>–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å</i> - \n"
            "2. <i>–†–∞–∑–≤–∏—Ç–∏–µ</i> - \n"
            "3. <i>–†–µ–∑—É–ª—å—Ç–∞—Ç</i> - \n\n"
            "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–Ω—É—é <b>–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –æ –∫–æ–º–ø–∞–Ω–∏–∏</b> –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ:\n"
            "<a href=''>–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–º–ø–∞–Ω–∏–∏</a>"
        )
    ),
    # –í —Ñ–∞–π–ª–µ seed_db.py
    Topic(
        title="üìÑ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ",
        content=(
            "<b>–ò–Ω—Ñ–∞ –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –í–ê–ñ–ù–´–ï –ù–û–í–û–°–¢–ò:</b>\n\n"
            # ... (–≤–µ—Å—å –≤–∞—à —Ç–µ–∫—Å—Ç —Å—é–¥–∞)
        ),
        image_path='static/images/statement_sample.jpg'  # <-- –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£
    ),
    Topic(
        title="üéÅ –ë–æ–Ω—É—Å—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã",
        content=(
            "<b>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞:</b>\n"
            "–ü—Ä–∏–≤–µ–¥–∏ –¥—Ä—É–≥–∞ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—É—é –≤–∞–∫–∞–Ω—Å–∏—é –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å! –ü–æ–¥—Ä–æ–±–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ —Å–ø–∏—Å–æ–∫ –≤–∞–∫–∞–Ω—Å–∏–π –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∑–¥–µ—Å—å:\n"
            "<a href=''>–£—Å–ª–æ–≤–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</a>\n\n"
            "<b>–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∫–∏–¥–∫–∏:</b>\n"
            "–ù–∞—à–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —Å–∫–∏–¥–∫–∏ —É –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤. –°–ø–∏—Å–æ–∫ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (—Ñ–∏—Ç–Ω–µ—Å, –æ–±—É—á–µ–Ω–∏–µ, –∫–∞—Ñ–µ) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç—É—Ç:\n"
            "<a href=''>–°–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö —Å–∫–∏–¥–æ–∫</a>"
        )
    ),
    Topic(
        title="üí¨ –ù–∞—à–∏ —á–∞—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã",
        content=(
            "<b>–ù–∞—à–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —á–∞—Ç—ã:</b>\n"
            "‚Ä¢ <a href=''>Backstage (Telegram)</a> - –Ω–∞—à –≥–ª–∞–≤–Ω—ã–π —á–∞—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è.\n"
            "‚Ä¢ <a href=''>WhatsApp-–≥—Ä—É–ø–ø–∞</a> - –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π.\n"
            "‚Ä¢ <a href=''>–§–ª—É–¥–∏–ª–∫–∞</a> - –¥–ª—è –º–µ–º–æ–≤ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –Ω–µ –ø–æ —Ä–∞–±–æ—Ç–µ.\n\n"
            "<b>–û–±—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã:</b>\n"
            "–í—Å–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã, —Ç–∞–±–ª–∏—Ü—ã –∏ —á–µ–∫-–ª–∏—Å—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ –Ω–∞—à–µ–º –æ–±—â–µ–º –¥–∏—Å–∫–µ:\n"
            "‚Ä¢ <a href=''>–û–±—â–∏–π –¥–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–∏</a>\n\n"
            "<b>–§–æ—Ç–æ–∞–ª—å–±–æ–º:</b>\n"
            "–í—Å–ø–æ–º–∏–Ω–∞–µ–º –ª—É—á—à–∏–µ –º–æ–º–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–µ! –°—Å—ã–ª–∫–∞ –Ω–∞ –Ω–∞—à –æ–±—â–∏–π —Ñ–æ—Ç–æ–∞–ª—å–±–æ–º:\n"
            "‚Ä¢ <a href=''>–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ç–æ–∞–ª—å–±–æ–º</a>"
        )
    ),
    Topic(
        title="üéâ –¢—Ä–∞–¥–∏—Ü–∏–∏ –∏ –∫—É–ª—å—Ç—É—Ä–∞",
        content=(
            "<b>–ù–∞—à–∏ —Ç—Ä–∞–¥–∏—Ü–∏–∏:</b>\n"
            "‚Ä¢ <b>–ü–æ —á–µ—Ç–≤–µ—Ä–≥–∞–º</b> –º—ã .\n"
            "‚Ä¢ <b>–¢—Ä–∞–¥–∏—Ü–∏–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º:</b> –í –ê–ª–º–∞—Ç—ã –º—ã..., –≤ –ê—Å—Ç–∞–Ω–µ –º—ã...\n"
            "‚Ä¢ <b>–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è:</b> –ú—ã –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –∫–æ–ª–ª–µ–≥ —Å –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è –≤ –æ–±—â–µ–º —á–∞—Ç–µ –∏ –¥–∞—Ä–∏–º –ø–æ–¥–∞—Ä–∫–∏. –û—Ç–¥—ã—Ö–∞–µ–º –Ω–∞ –≤—Å–µ—Ö –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–∞—Ö!\n\n"
            "<b>–û—Ç–∑—ã–≤—ã –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:</b>\n"
            "–ü–æ—á–∏—Ç–∞—Ç—å –æ—Ç–∑—ã–≤—ã –æ –Ω–∞—à–∏—Ö —Ç–∏–º–±–∏–ª–¥–∏–Ω–≥–∞—Ö –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–æ—Ç–æ –º–æ–∂–Ω–æ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ:\n"
            "<a href=''>–û—Ç–∑—ã–≤—ã –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è—Ö</a>"
        )
    ),
    Topic(
        title="üìö –†–µ–≥–ª–∞–º–µ–Ω—Ç—ã –∏ –≥–∞–π–¥—ã",
        content=(
            "–ú—ã —Å–æ–±—Ä–∞–ª–∏ –≤—Å–µ –ø–æ–ª–µ–∑–Ω—ã–µ –≥–∞–π–¥—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ!\n\n"
            "–ó–¥–µ—Å—å –≤—ã –Ω–∞–π–¥–µ—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –¥–∏–∑–∞–π–Ω—É, —Ñ–∏–Ω–∞–Ω—Å–∞–º, HR –∏ –¥—Ä—É–≥–∏–º –æ—Ç–¥–µ–ª–∞–º. –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.\n\n"
            "–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ –Ω–∞—à—É —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é –±–∞–∑—É –∑–Ω–∞–Ω–∏–π:\n"
            "‚û°Ô∏è <a href=''><b>–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π</b></a>"
        )
    ),
    Topic(
        title="üß† –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å",
        content=(
            "–ù–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —è–∑—ã–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Ç—å –Ω–∞ –æ–¥–Ω–æ–π –≤–æ–ª–Ω–µ:\n\n"
            "üìò <b>¬´Backstage¬ª</b> ‚Äî <i>–Ω–∞—à –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–∞–Ω–¥–Ω—ã–π —á–∞—Ç –≤ Telegram.</i>\n\n"
            "ü§ù <b>¬´–í–∞–π–±-–¥—ç–π¬ª</b> ‚Äî <i>–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞ –∫–æ–º–∞–Ω–¥—ã –ø–æ –ø—è—Ç–Ω–∏—Ü–∞–º –¥–ª—è –æ–±–º–µ–Ω–∞ –Ω–æ–≤–æ—Å—Ç—è–º–∏.</i>\n\n"
            "üìä <b>¬´–¶–ö–ü¬ª</b> ‚Äî <i>–¶–µ–ª–∏ –∏ –ö–ª—é—á–µ–≤—ã–µ –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏, –Ω–∞—à–∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—ã –≤ —Ä–∞–±–æ—Ç–µ.</i>\n\n"
            "üåÄ <b>¬´–°–ø–∏–∫–∏–Ω–≥¬ª</b> ‚Äî <i>Speaking Club, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞.</i>\n\n"
            "üí° <i>–≠—Ç–æ—Ç —Å–ª–æ–≤–∞—Ä—å –º–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å! –ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ —Å–≤–æ–∏ —Ç–µ—Ä–º–∏–Ω—ã –≤ –æ–±—â–µ–º —á–∞—Ç–µ.</i>"
        )
    ),
]

# --- –õ–æ–≥–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è ---
if __name__ == "__main__":
    with get_session() as db:
        print("–û–±–Ω–æ–≤–ª—è–µ–º –ë–∞–∑—É –∑–Ω–∞–Ω–∏–π...")
        for topic in topics_to_add:
            # –ò—â–µ–º —Ç–æ–ø–∏–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É
            existing_topic = db.query(Topic).filter_by(title=topic.title).first()
            if existing_topic:
                # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω - –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                existing_topic.content = topic.content
                print(f"  - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–µ–º–∞: '{topic.title}'")
            else:
                # –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω - –¥–æ–±–∞–≤–ª—è–µ–º –∫–∞–∫ –Ω–æ–≤—ã–π
                db.add(topic)
                print(f"  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ç–µ–º–∞: '{topic.title}'")

        db.commit()
        print("–ì–æ—Ç–æ–≤–æ!")